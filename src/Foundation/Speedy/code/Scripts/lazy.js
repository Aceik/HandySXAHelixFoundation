!function (e, t) { "function" == typeof define && define.amd ? define(function () { return t(e) }) : "object" == typeof exports ? module.exports = t : e.progressively = t(e) }(this, function (e) { "use strict"; function t(e) { var t = e.getBoundingClientRect(), o = t.top, n = t.height; e = e.parentNode; do { if (!(o <= (t = e.getBoundingClientRect()).bottom)) return !1; if (o + n <= t.top) return !1; e = e.parentNode } while (e !== document.body && e !== document); return o <= document.documentElement.clientHeight } function o(e, t) { setTimeout(function () { var o = new Image; o.onload = function () { e.classList.remove("progressive--not-loaded"), e.classList.add("progressive--is-loaded"), e.classList.contains("progressive__bg") ? e.style["background-image"] = 'url("' + this.src + '")' : e.src = this.src, i(e) }, Math.max(document.documentElement.clientWidth, window.innerWidth || 0) <= t.smBreakpoint && e.getAttribute("data-progressive-sm") ? (e.classList.add("progressive--loaded-sm"), o.src = e.getAttribute("data-progressive-sm")) : (e.classList.remove("progressive--loaded-sm"), o.src = e.getAttribute("data-progressive")) }, t.delay) } function n() { a || (clearTimeout(a), a = setTimeout(function () { l.check(), l.render(), a = null }, r.throttle)) } var r, a, i, s, l = {}; return i = function () { }, r = { throttle: 300, delay: 100, onLoadComplete: function () { }, onLoad: function () { }, smBreakpoint: 600 }, l.init = function (t) { r = function (e, t) { var o = {}; for (var n in e) o[n] = t.hasOwnProperty(n) ? t[n] : e[n]; return o }(r, t = t || {}), i = r.onLoad || i, s = [].slice.call(document.querySelectorAll(".progressive__img, .progressive__bg")), l.render(), document.addEventListener ? (e.addEventListener("scroll", n, !1), e.addEventListener("resize", n, !1), e.addEventListener("load", n, !1)) : (e.attachEvent("onscroll", n), e.attachEvent("onresize", n), e.attachEvent("onload", n)) }, l.render = function () { for (var e, n = s.length - 1; n >= 0; --n)t(e = s[n]) && e.classList.contains("progressive--not-loaded") && (o(e, r), s.splice(n, 1)); this.check() }, l.check = function () { s.length || (r.onLoadComplete(), this.drop()) }, l.drop = function () { document.removeEventListener ? (e.removeEventListener("scroll", n), e.removeEventListener("resize", n)) : (e.detachEvent("onscroll", n), e.detachEvent("onresize", n)), clearTimeout(a) }, l }); var Lazy = { tools: { setCookie: function (e, t, o) { var n = new Date; n.setTime(n.getTime() + 24 * o * 60 * 60 * 1e3); var r = "expires=" + n.toUTCString(); document.cookie = e + "=" + t + ";" + r + ";path=/" }, getCookie: function (e) { for (var t = e + "=", o = document.cookie.split(";"); 0 < o.length;) { for (var n = o[0]; " " == n.charAt(0);)n = n.substring(1); if (0 == n.indexOf(t)) return n.substring(t.length, n.length) } return "" }, checkCookie: function (e) { return "" != Lazy.tools.getCookie(e) }, runSelector: function (e, t) { var o = document.querySelectorAll(e); o && o.forEach(function (e) { e.style.display = t }) } }, lazyLoading: { onceOffCarousel: !1, onceOffOthers: !1, bootup: function () { if (Lazy.tools.checkCookie("habitatlazy")) { const e = Array.prototype.slice.call(document.querySelectorAll("img[data-progressive]")); Promise.all(e.map(e => { const t = e.dataset.progressive; e.classList.add("progressive--is-loaded"), e.classList.add("progressive__img"), e.setAttribute("src", t), e.datasrc && e.datasrc.alt && e.setAttribute("alt", e.datasrc.alt), e.removeAttribute("data-progressive"), e.removeAttribute("data-alt") })).then(e => { console.log("images fast loaded fromt cache") }) } else console.log("starting lazy loading of images"), Lazy.lazyLoading.pollCarouselLoaded(), Lazy.tools.setCookie("habitatlazy") }, prepareNavigationImages: function () { document.querySelectorAll(".field-navigation-image > img, .megadrop-secondary-main-image > a > img").forEach(function (e) { e.src = e.getAttribute("data-progressive"), e.classList.remove("progressive--not-loaded"), e.classList.add("progressive--is-loaded") }) }, startProgressively: function () { progressively.init({ delay: 2e3, throttle: 200, smBreakpoint: 600, onLoad: function (e) { }, onLoadComplete: function () { } }), Lazy.lazyLoading.beginPoll() }, beginPoll: function () { progressively && progressively.render && progressively.render(), setTimeout(function () { Lazy.lazyLoading.beginPoll() }, 500) }, pollCarouselLoaded: function () { Lazy.lazyLoading.onceOffCarousel ? Lazy.lazyLoading.onceOffOthers || (Lazy.lazyLoading.prepareNavigationImages(), Lazy.lazyLoading.startProgressively(), Lazy.lazyLoading.onceOffOthers = !0) : (document.querySelectorAll("[data-variantfieldname*='BlurredImage']").forEach(function (e) { e.classList.add("progressive__img"), e.classList.add("progressive--not-loaded"), Lazy.lazyLoading.onceOffCarousel = !0 }), setTimeout(function () { Lazy.lazyLoading.pollCarouselLoaded() }, 500)) } } }; setTimeout(function () { Lazy.lazyLoading.bootup() }, 100);
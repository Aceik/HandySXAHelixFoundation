<configuration xmlns:role="http://www.sitecore.net/xmlconfig/role/" xmlns:patch="http://www.sitecore.net/xmlconfig/"
               xmlns:set="http://www.sitecore.net/xmlconfig/set/">
  <sitecore role:require="Standalone">
    <api>
      <services>
        <configuration
            type="Sitecore.Services.Infrastructure.Configuration.ServicesConfiguration, Sitecore.Services.Infrastructure">
          <allowedControllers hint="list:AddController">
            <allowedController desc="CriticalApiController">Site.Foundation.PageSpeed.Controllers.CriticalApiController, Site.Foundation.PageSpeed</allowedController>
          </allowedControllers>
        </configuration>
      </services>
    </api>
    <pipelines>
      <initialize>
        <processor type="Site.Foundation.PageSpeed.Routes, Site.Foundation.PageSpeed" patch:before="processor[@type='Sitecore.Mvc.Pipelines.Loader.InitializeRoutes, Sitecore.Mvc']" resolve="true" />
      </initialize>
    </pipelines>
  </sitecore>
</configuration>